{"version":3,"sources":["webpack:///./js/Api/apiService.js","webpack:///./js/loadMoreBtn.js","webpack:///./index.js","webpack:///./templates/imageList.hbs"],"names":["error","require","apiService","this","searchQuery","page","fetchHits","url","BASE_URL","fetch","then","response","json","hits","incrementPage","console","log","length","title","text","catch","resetPage","newQuery","LoadMoreBtn","selector","hidden","refs","getRefs","hide","button","document","querySelector","label","spinner","enable","disabled","textContent","classList","add","disable","remove","show","debounce","searchForm","galleryList","input","sentinel","loadMoreBtn","addHitsMarkup","insertAdjacentHTML","imageListTpl","clearHitsContainer","innerHTML","addEventListener","e","preventDefault","hitsApiService","query","target","value","trim","event","nodeName","changeModalImage","dataset","source","basicLightbox","HitsApiService","IntersectionObserver","entries","forEach","entry","isIntersecting","rootMargin","observe","Handlebars","module","exports","template","container","depth0","helpers","partials","data","alias1","lambda","alias2","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","stack1","nullContext","program","noop"],"mappings":"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","file":"main.7868accaee3c4873a75b.js","sourcesContent":["// import '../css/styles.css';\r\nimport \"@pnotify/core/dist/PNotify.css\";\r\nimport\"@pnotify/core/dist/BrightTheme.css\";\r\n\r\nconst { error } = require('@pnotify/core');\r\n\r\nconst BASE_URL = 'https://pixabay.com/api/';\r\nconst API_KEY = '19136435-96f0ae3906c94a349fe1f1440';\r\n\r\nexport default class apiService {\r\n    constructor() {\r\n        this.searchQuery = '';\r\n        this.page = 1;\r\n    }\r\n\r\n    fetchHits() {\r\n        const url = `${BASE_URL}?key=${API_KEY}&q=${this.searchQuery}&image_type=photo&per_page=12&page=${this.page}`;\r\n\r\n        return fetch(url)\r\n            .then(response => response.json())\r\n            .then(({hits}) => {\r\n                this.incrementPage();\r\n                console.log(this.page);\r\n                if(hits.length === 0) {\r\n                    error({\r\n                        title: 'Oh No!',\r\n                        text: 'No matches were found for this request. Please enter a correct request',\r\n                      });\r\n                }\r\n\r\n                return hits;                \r\n            })\r\n            .catch(() => {\r\n                error({\r\n                    title: 'Oops!',\r\n                    text: \"Something went wrong! Try again!\",\r\n                })\r\n            });\r\n    }\r\n\r\n    incrementPage() {\r\n        this.page += 1;\r\n    }\r\n\r\n    resetPage() {\r\n        this.page = 1;\r\n    }\r\n\r\n    // Если убрать get и set, тогда везьде обращаемся только к searchQuery, a не query \r\n    get query() {\r\n        return this.searchQuery;\r\n    }\r\n\r\n    set query(newQuery) {\r\n        this.searchQuery = newQuery;\r\n    }\r\n}","export default class LoadMoreBtn {\r\n    constructor({ selector, hidden = false }) {\r\n      this.refs = this.getRefs(selector);\r\n  \r\n    //   если hidden тогда вызываем hide\r\n      hidden && this.hide();\r\n    }\r\n  \r\n    getRefs(selector) {\r\n      const refs = {};\r\n      refs.button = document.querySelector(selector);\r\n      refs.label = refs.button.querySelector('.label');\r\n      refs.spinner = refs.button.querySelector('.spinner');\r\n  \r\n      return refs;\r\n    }\r\n  \r\n    enable() {\r\n      this.refs.button.disabled = false;\r\n      this.refs.label.textContent = 'Показать ещё';\r\n      this.refs.spinner.classList.add('is-hidden');\r\n    }\r\n  \r\n    disable() {\r\n      this.refs.button.disabled = true;\r\n      this.refs.label.textContent = 'Загружаем...';\r\n      this.refs.spinner.classList.remove('is-hidden');\r\n    }\r\n  \r\n    show() {\r\n      this.refs.button.classList.remove('is-hidden');\r\n    }\r\n  \r\n    hide() {\r\n      this.refs.button.classList.add('is-hidden');\r\n    }\r\n  }","import './css/styles.css';\r\nimport imageListTpl from './templates/imageList.hbs';\r\nimport HitsApiService from './js/Api/apiService';\r\nimport infiniteScroll from 'infinite-scroll';\r\nimport LoadMoreBtn from './js/loadMoreBtn';\r\nimport * as basicLightbox from 'basiclightbox';\r\nimport 'basiclightbox/dist/basicLightbox.min.css';\r\n\r\nvar debounce = require('lodash.debounce');\r\n\r\nconst refs ={\r\n    searchForm: document.querySelector('.search-form'),\r\n    galleryList: document.querySelector('.gallery'),\r\n    input: document.querySelector('.search-input'),\r\n    sentinel: document.querySelector('#sentinel'),\r\n};\r\n\r\nconst loadMoreBtn = new LoadMoreBtn({\r\n    selector: '[data-action=\"load-more\"]',\r\n    hidden: true,\r\n});\r\n\r\nrefs.input.addEventListener('input', debounce(onSearch, 500));\r\n// loadMoreBtn.refs.button.addEventListener('click', onLoadMore);\r\nrefs.galleryList.addEventListener('click', onGalleryElClick); \r\n\r\nfunction onSearch(e) {\r\n    e.preventDefault();\r\n\r\n    hitsApiService.query = e.target.value.trim();\r\n    if(hitsApiService.query.length === 0) {\r\n        return clearHitsContainer();\r\n    }\r\n    // Прячем кнопку\r\n    // loadMoreBtn.show();\r\n    hitsApiService.resetPage();\r\n    clearHitsContainer();\r\n    onLoadMore(); \r\n}\r\n\r\nfunction onLoadMore() {\r\n    loadMoreBtn.disable();\r\n    hitsApiService.fetchHits().then(hits => {\r\n        addHitsMarkup(hits);\r\n        // scrollPage();\r\n        loadMoreBtn.enable();\r\n    });\r\n}\r\n\r\nfunction addHitsMarkup(hits) {\r\n    refs.galleryList.insertAdjacentHTML('beforeend', imageListTpl(hits));\r\n}\r\n\r\nfunction clearHitsContainer() {\r\n refs.galleryList.innerHTML = '';    \r\n}\r\n\r\n// function scrollPage() {\r\n//       try {\r\n//         setTimeout(() => {\r\n//           window.scrollTo({\r\n//             top: document.body.scrollHeight,\r\n//             left: 0,\r\n//             behavior: 'smooth',\r\n//           });\r\n//         }, 1000);\r\n//       } catch (error) {\r\n//         console.log(error);\r\n//       }\r\n//     }\r\n\r\n    const hitsApiService = new HitsApiService();\r\n\r\n    const onEntry = entries => {\r\n        entries.forEach(entry => {\r\n            if (entry.isIntersecting && hitsApiService.query !== '') {\r\n                console.log(\"LOADING...\");\r\n                hitsApiService.fetchHits().then(hits => {\r\n                    addHitsMarkup(hits);\r\n                    hitsApiService.incrementPage();\r\n                });\r\n            }\r\n        });\r\n    }\r\n    const options = {\r\n        rootMargin: '100px'\r\n    }\r\n    const observer = new IntersectionObserver(onEntry, options);\r\n    observer.observe(refs.sentinel);\r\n\r\nfunction onGalleryElClick(event) {\r\n        if (event.target.nodeName !== 'IMG') {\r\n          return;\r\n        }\r\n        \r\n        const changeModalImage = `<img src=${event.target.dataset.source} alt=\"icon\" />`;\r\n        const instance = basicLightbox.create(changeModalImage);\r\n        instance.show();\r\n }","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    var alias1=container.lambda, alias2=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"photo-card\\\">\\r\\n<img src=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0), depth0))\n    + \"\\\" data-source=\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"largeImageURL\") : depth0), depth0))\n    + \" alt=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"tags\") : depth0), depth0))\n    + \"\\\" width=\\\"400\\\" />\\r\\n\\r\\n  <div class=\\\"stats\\\">\\r\\n    <p class=\\\"stats-item\\\">\\r\\n      <i class=\\\"material-icons\\\">thumb_up</i>\\r\\n      \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"likes\") : depth0), depth0))\n    + \"\\r\\n    </p>\\r\\n    <p class=\\\"stats-item\\\">\\r\\n      <i class=\\\"material-icons\\\">visibility</i>\\r\\n      \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"views\") : depth0), depth0))\n    + \"\\r\\n    </p>\\r\\n    <p class=\\\"stats-item\\\">\\r\\n      <i class=\\\"material-icons\\\">comment</i>\\r\\n      \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"comments\") : depth0), depth0))\n    + \"\\r\\n    </p>\\r\\n    <p class=\\\"stats-item\\\">\\r\\n      <i class=\\\"material-icons\\\">cloud_download</i>\\r\\n      \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0), depth0))\n    + \"\\r\\n    </p>\\r\\n  </div>\\r\\n</div>\\r\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),depth0,{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":1,\"column\":0},\"end\":{\"line\":24,\"column\":9}}})) != null ? stack1 : \"\");\n},\"useData\":true});"],"sourceRoot":""}